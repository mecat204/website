<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>2D 居中滑动相册（平滑版）</title>
<style>
* {margin:0; padding:0; box-sizing:border-box;}
body {background:#000; display:flex; justify-content:center; align-items:center; height:100vh; overflow:hidden;}

#album3d {
  width: 100vw;
  height: 360px;
  position: relative;
  overflow: visible;
}

.carousel {
  width: 100%;
  height: 100%;
  position: relative;
}

.track {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  height: 100%;
}

.item {
  position: absolute;
  width: 220px;
  height: 300px;
  transition: transform 0.3s ease, opacity 0.3s ease;
}

.item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 12px;
  box-shadow: 0 8px 15px rgba(255,30,90,0.25);
  -webkit-box-reflect: below 6px linear-gradient(transparent, rgba(0,0,0,0.4));
}
</style>
</head>
<body>

<div id="album3d">
  <div class="carousel">
    <div class="track">
      <div class="item"><img src="./me.pic/images/0001.jpeg"></div>
      <div class="item"><img src="./me.pic/images/0002.jpeg"></div>
      <div class="item"><img src="./me.pic/images/0003.jpeg"></div>
      <div class="item"><img src="./me.pic/images/0004.jpeg"></div>
      <div class="item"><img src="./me.pic/images/0005.jpeg"></div>
      <div class="item"><img src="./me.pic/images/0006.jpeg"></div>
      <div class="item"><img src="./me.pic/images/0007.jpeg"></div>
      <div class="item"><img src="./me.pic/images/0008.jpeg"></div>
    </div>
  </div>
</div>

<script>
const items = [...document.querySelectorAll(".item")];
const GAP = 260;
const SCALE_CENTER = 1.25;
const VISIBLE = 5;
let current = 0;

let isDown = false;
let startX = 0;
let offsetX = 0;
let velocity = 0;

// 更新布局
function update(offset=0){
  const len = items.length;
  for(let i=0;i<len;i++){
    let diff = i-current;
    if(diff>len/2) diff -= len;
    if(diff<-len/2) diff += len;
    const abs = Math.abs(diff);

    if(abs > Math.floor(VISIBLE/2)){
      items[i].style.opacity=0;
      items[i].style.transform=`translateX(${offset}px) scale(0.6)`;
      continue;
    }

    const x = diff*GAP + offset;
    const scale = SCALE_CENTER - abs*0.15;
    const opacity = 1 - abs*0.25;
    items[i].style.opacity = opacity;
    items[i].style.transform = `translateX(${x}px) scale(${scale})`;
  }
}

update();

// 拖拽逻辑
function pointerDown(e){
  isDown = true;
  startX = e.clientX || e.touches?.[0].clientX;
  velocity = 0;
}
function pointerMove(e){
  if(!isDown) return;
  const x = e.clientX || e.touches?.[0].clientX;
  const dx = x - startX;
  offsetX = dx;
  velocity = dx;
  update(offsetX);
}
function pointerUp(){
  if(!isDown) return;
  isDown = false;

  // 根据偏移判断切换张数
  if(Math.abs(offsetX) > GAP/2){
    if(offsetX < 0){
      current = (current + 1) % items.length;
    } else {
      current = (current - 1 + items.length) % items.length;
    }
  }
  offsetX = 0;
  update();

  // 惯性滑动
  if(Math.abs(velocity) > 0){
    let decay = velocity;
    let anim = setInterval(()=>{
      decay *= 0.95;
      if(Math.abs(decay)<1){
        clearInterval(anim);
        update();
      } else {
        update(decay);
      }
    },16);
  }
}

document.addEventListener("pointerdown", pointerDown);
document.addEventListener("pointermove", pointerMove);
document.addEventListener("pointerup", pointerUp);
document.addEventListener("pointercancel", pointerUp);
</script>

</body>
</html>
