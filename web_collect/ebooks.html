<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8" />
  <title>EPUB Reader Example</title>
  <script src="https://unpkg.com/epubjs/dist/epub.min.js"></script>

  <style>
    body {
      margin: 0;
      height: 100vh;
      overflow: hidden;
      background: #f1f1f1;
      font-family: sans-serif;
    }
    #viewer {
      width: 100%;
      height: calc(100vh - 60px);
      background: #fff;
    }
    #controls {
      height: 60px;
      display: flex;
      align-items: center;
      background: #222;
      padding: 0 16px;
      color: #fff;
    }
    button {
      margin-right: 10px;
      padding: 6px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      background: #444;
      color: #fff;
    }
    button:hover {
      background: #666;
    }
  </style>
</head>

<body>
  <!-- 控制区 -->
  <div id="controls">
    <button id="prev-btn">上一页</button>
    <button id="next-btn">下一页</button>
    <button id="toc-btn">目录</button>
    <span style="margin-left:20px;">当前章节：<span id="chapter-title"></span></span>
  </div>

  <!-- 阅读区 -->
  <div id="viewer"></div>

  <script>
    // ① 加载 EPUB 文件
    const book = ePub("/website/source/book/《菜根谭》 (洪应明).epub");   // ← 把你的 epub 文件放在同目录下

    // ② 渲染到 #viewer 容器
    const rendition = book.renderTo("viewer", {
      width: "100%",
      height: "100%",
    });

    // ③ 显示第一章
    rendition.display();

    // ④ 翻页按钮
    document.getElementById("prev-btn").onclick = () => rendition.prev();
    document.getElementById("next-btn").onclick = () => rendition.next();

    // ⑤ 显示当前章节标题
    rendition.on("rendered", (section) => {
      const currentTitle = book.navigation?.get(section.href)?.label || "";
      document.getElementById("chapter-title").innerText = currentTitle;
    });

    // ⑥ 显示目录（console 输出，可做 UI）
    document.getElementById("toc-btn").onclick = () => {
      book.loaded.navigation.then((nav) => {
        console.log("目录：", nav.toc);
        alert("目录已输出到控制台（F12 Console）");
      });
    };
  </script>
</body>
</html>
